<div class="blank-layout-container justify-content-center align-items-center bg-light">
  <div class="position-relative row w-100 h-100 bg-gradient justify-content-center">
    <div class="col-lg-4 d-flex align-items-center">
      <mat-card class="cardWithShadow boxed-auth">
        <mat-card-content class="p-32">

          <!-- Círculo con logo arriba -->
          <div class="d-flex justify-content-center mb-3">
            <div
              style="width:80px;height:80px;border-radius:50%;background:#f5f5f5;display:flex;align-items:center;justify-content:center;box-shadow:0 2px 8px rgba(0,0,0,0.08);">
              <!-- Aquí podrías colocar tu logo si quieres -->
              <mat-icon color="primary" style="font-size:40px;">person_add</mat-icon>
            </div>
          </div>

          <!-- ✅ Se usa (ngSubmit) para manejar el envío -->
          <form class="m-t-30" [formGroup]="form" (ngSubmit)="submit()">

            <!-- Nombre de usuario -->
            <mat-label class="f-s-14 f-w-600 m-b-12 d-block">Nombre de usuario</mat-label>
            <mat-form-field appearance="outline" class="w-100" color="primary">
              <input matInput formControlName="uname" placeholder="Ingresa tu nombre de usuario" />
              <mat-error *ngIf="form.get('uname')?.hasError('required')">
                El nombre de usuario es obligatorio
              </mat-error>
              <mat-error *ngIf="form.get('uname')?.hasError('minlength')">
                El nombre de usuario debe tener al menos 6 caracteres
              </mat-error>
            </mat-form-field>

            <!-- Correo electrónico -->
            <mat-label class="f-s-14 f-w-600 m-b-12 d-block">Correo electrónico</mat-label>
            <mat-form-field appearance="outline" class="w-100" color="primary">
              <!-- Puedes activar la verificación en tiempo real con (blur)="verificarCorreo()" -->
              <input
                matInput
                formControlName="email"
                placeholder="Ingresa tu correo electrónico"
                (blur)="verificarCorreo()"
              />
              <mat-error *ngIf="form.get('email')?.hasError('required')">
                El correo electrónico es obligatorio
              </mat-error>
              <mat-error *ngIf="form.get('email')?.hasError('email')">
                Correo electrónico inválido
              </mat-error>
              <mat-error *ngIf="emailYaRegistrado || form.get('email')?.hasError('emailRegistrado')">
                El correo ya está registrado
              </mat-error>
            </mat-form-field>

            <!-- Teléfono -->
            <mat-label class="f-s-14 f-w-600 m-b-12 d-block">Teléfono</mat-label>
            <mat-form-field appearance="outline" class="w-100" color="primary">
              <input matInput formControlName="telefono" placeholder="Ingresa tu teléfono" />
              <mat-error *ngIf="form.get('telefono')?.hasError('required')">
                El teléfono es obligatorio
              </mat-error>
              <mat-error *ngIf="form.get('telefono')?.hasError('pattern')">
                Teléfono inválido (solo números, entre 7 y 15 dígitos)
              </mat-error>
            </mat-form-field>

            <!-- Gustos -->
            <mat-label class="f-s-14 f-w-600 m-b-12 d-block">¿Qué gustos tienes?</mat-label>
            <mat-form-field appearance="outline" class="w-100" color="primary">
              <input matInput formControlName="gustos" placeholder="Escribe tus gustos o intereses" />
              <mat-error *ngIf="form.get('gustos')?.hasError('required')">
                Este campo es obligatorio
              </mat-error>
            </mat-form-field>

            <!-- Contraseña -->
            <mat-label class="f-s-14 f-w-600 m-b-12 d-block">Contraseña</mat-label>
            <mat-form-field appearance="outline" class="w-100" color="primary">
              <input matInput type="password" formControlName="password" placeholder="Ingresa tu contraseña" />
              <mat-error *ngIf="form.get('password')?.hasError('required')">
                La contraseña es obligatoria
              </mat-error>
              <mat-error *ngIf="form.get('password')?.hasError('minlength')">
                La contraseña debe tener al menos 6 caracteres
              </mat-error>
            </mat-form-field>

            <!-- Verificar contraseña -->
            <mat-label class="f-s-14 f-w-600 m-b-12 d-block">Verificar contraseña</mat-label>
            <mat-form-field appearance="outline" class="w-100" color="primary">
              <input matInput type="password" formControlName="verificarPassword" placeholder="Repite tu contraseña" />
              <mat-error *ngIf="form.get('verificarPassword')?.hasError('required')">
                Debes verificar la contraseña
              </mat-error>
              <mat-error *ngIf="form.hasError('passwordsNoCoinciden')">
                Las contraseñas no coinciden
              </mat-error>
            </mat-form-field>

            <!-- Botón principal -->
            <button
              mat-flat-button
              color="primary"
              class="w-100"
              type="submit"
              [disabled]="form.invalid">
              Registrarse
            </button>
          </form>

          <!-- Error general -->
          <div *ngIf="errorMsg" class="text-danger text-center m-t-16">
            {{ errorMsg }}
          </div>

          <!-- Enlace de inicio de sesión -->
          <span class="d-block f-w-500 text-center m-t-24">
            ¿Ya tienes una cuenta?
            <a
              [routerLink]="['/authentication']"
              class="text-primary text-decoration-none f-w-500 f-s-14"
              style="cursor:pointer;">
              Iniciar sesión
            </a>
          </span>
        </mat-card-content>
      </mat-card>
    </div>
  </div>
</div>
