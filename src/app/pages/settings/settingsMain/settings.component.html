<div class="settings-container">
  <!-- Sidebar -->
  <aside class="settings-sidebar">
    <h2 class="settings-title">Settings</h2>
    <ul>
      <li
        (click)="navigate('/settings/profile')"
        [class.active]="currentRoute === '/settings/profile'"
      >
        Edit Profile
      </li>

      <li
        (click)="navigate('/settings/password')"
        [class.active]="currentRoute === '/settings/password'"
      >
        Change Password
      </li>

      <li
        (click)="navigate('/settings/notifications')"
        [class.active]="currentRoute === '/settings/notifications'"
      >
        Notifications
      </li>

      <li
        (click)="navigate('/settings/privacy')"
        [class.active]="currentRoute === '/settings/privacy'"
      >
        Privacy
      </li>
    </ul>
  </aside>

  <!-- Main Content -->
  <section class="settings-content" *ngIf="profileForm">
    <h3>Edit Profile</h3>

    <div class="profile-card" style="position: relative;">
      <!-- Botón de editar -->
      <button
        type="button"
        class="edit-btn"
        (click)="toggleEditMode()"
        aria-label="Editar perfil"
        style="position: absolute; top: 10px; right: 10px; background: none; border: none; cursor: pointer;"
      >
        <mat-icon>{{ editMode ? 'close' : 'edit' }}</mat-icon>
      </button>

      <img
        [src]="profileForm.value?.profile_img ? profileForm.value.profile_img : 'assets/images/avatar.png'"
        alt="User avatar"
        class="profile-avatar"
      />

      <div class="profile-info">
        <h4>{{ profileForm.value?.user_name || 'User' }}</h4>
        <button class="btn-secondary" type="button" (click)="onUploadPhoto()">
          Change Photo
        </button>
      </div>
    </div>

    <form [formGroup]="profileForm" (ngSubmit)="onSubmit()">
      <!-- Username -->
      <div class="form-group">
        <label>Username</label>
        <ng-container *ngIf="editMode; else showUsername">
          <input type="text" formControlName="user_name" placeholder="Enter your username" />
        </ng-container>
        <ng-template #showUsername>
          <div class="profile-data">{{ profileForm.value?.user_name || 'Sin usuario' }}</div>
        </ng-template>
      </div>

      <!-- Email solo lectura -->
    <div class="form-group">
      <label>Email</label>
      <div class="profile-data">{{ profileForm.value?.email || 'Sin correo' }}</div>
    </div>


      <!-- Phone -->
      <div class="form-group">
        <label>Phone Number</label>
        <ng-container *ngIf="editMode; else showPhone">
          <input type="text" formControlName="phone_number" placeholder="+57 300 123 4567" />
        </ng-container>
        <ng-template #showPhone>
          <div class="profile-data">{{ profileForm.value?.phone_number || 'Sin teléfono' }}</div>
        </ng-template>
      </div>

      <!-- Things you like -->
      <div class="form-group">
        <label>Things you like</label>
        <ng-container *ngIf="editMode; else showThings">
          <textarea
            formControlName="things_like"
            rows="3"
            maxlength="150"
            placeholder="e.g. Drones, electronics, travel..."
          ></textarea>
        </ng-container>
        <ng-template #showThings>
          <div class="profile-data">{{ profileForm.value?.things_like || 'Sin información' }}</div>
        </ng-template>
      </div>

      <!-- Botón guardar -->
      <button class="btn-primary" type="submit" *ngIf="editMode">Guardar cambios</button>
    </form>
  </section>
</div>
